---
title: "Trimming_loop"
author: "Matilda"
date: "2025-03-10"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```
This doc explains how to run Trimmomatic on multiple sets of paired end read files without having to manually write and execute a command for each set.

First you need to create a file with a command for each set of files. This can be done with a for loop.

The following loop creates an executable file with a command for each set of paired read files:
```{r}
for R1 in *R1*;
do
   R2=${R1//R1_001.fastq.gz/R2_001.fastq.gz}
   R1paired=${R1//.fastq.gz/_paired.fastq.gz}
   R1unpaired=${R1//.fastq.gz/_unpaired.fastq.gz}	
   R2paired=${R2//.fastq.gz/_paired.fastq.gz}
   R2unpaired=${R2//.fastq.gz/_unpaired.fastq.gz}	
   echo "apptainer exec ../containers/trimmomatic_0.39.sif trimmomatic PE -phred33 $R1 $R2 ../trimmomatic/trimmomatic_out/$R1paired ../trimmomatic/trimmomatic_out/$R1unpaired ../trimmomatic/trimmomatic_out/$R2paired ../trimmomatic/trimmomatic_out/$R2unpaired ILLUMINACLIP:../trimmomatic/overrep_seq.fa:2:30:10:2:True LEADING:3 TRAILING:3 SLIDINGWINDOW:4:15 MINLEN:36" >> ../trimmomatic/trimmomatic.sh;
done;
echo “echo “complete”” >> ../trimmomatic/trimmomatic.sh
```
The settings used here for Trimmomatic are very general, but can easily be changed - just edit the loop.

Keep in mind that the paths are relative and may need to be changed to fit your file system. As they are written you need to be in the directory containing the seq files.

The file with sequences to trim (overrep_seq.fa) is specific to my pusposes, you will need to replace that, either with a general option available with Trimmomatic (for example TruSeq3-PE.fa) or with your own file.

This uses a container with Trimmomatic (apptainer system) - installed versions have other commands.

You just copy the loop into a new .sh file and execute it with:
```{r}
bash <file_name>.sh
```

Then you just need to execute the file with the commands:
```{r}
bash ../trimmomatic/trimmomatic.sh
```

It may take some time to run. The output will be four files per paired set.
Recommend that you run QC after to make sure the trimming worked.
